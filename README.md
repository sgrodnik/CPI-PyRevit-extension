# Скрипты для PyRevit (CPI-extension)
### Инструкция по установке

[Скачать][1] и распаковать архив например в папку `C:\PyRevit\CPI-extension`. Указать путь `C:\PyRevit` (без подпапки `\CPI-extension`) в PyRevit->Settings и перезупустить PyRevit.

[1]: https://github.com/sgrodnik/CPI-PyRevit-extension/archive/refs/heads/master.zip

### Состав
#### 1. Отделка  
  Скрипт подсчитывает значения следующих параметров  
  ```- CPI_Плинтус_Длина  
  - CPI_Отбойник_Длина  
  - CPI_Чистовая_Площадь отделки  
  - CPI_Черновая-ХХХ_Площадь, где ХХХ - аббревиатура типа отделки, например ГКЛ, ГБ, ЖБ, КР (значение параметра CPI_Основа черновой отделки)
  ```
  Если в момент запуска скрипта в наборе выбранных элементов есть помещения, то просчитаются только они. В ином случае будут просчитаны все помещения проекта.  
  Для перманентного исключения помещения из обработки скриптом следует выключить галочку `CPI_Подсчёт отделки`. Например, это нужно для помещений с цоколем, т.к. скрипт их обрабатывает некорректно.  
  В помещениях с двойными стенами для верного учёта окон и дверей не следует «соединять» стены. Стены должны остаться несоединёнными, а окна и двери нужно моделировать (дублировать) ложными проёмами.  
  Для запуска без вывода отчёта следует удерживать клавишу `Shift`.
#### 2. Группировка номеров
  Скрипт производит круппировку номеров помещений и записывает в параметры `CPI_ХХХ_Номера помещений` для всех помещений в проекте. Для помещений с нулевой площадью прописывает «Не определено»
#### 3. Параметры листов
  Скрипт позволяет просмотреть значения параметров основных надписей для выделенных в диспетчере проекта листов и внести групповые изменения в эти параметры.  
  Основное требование  
  Количество и названия параметров в экземплярах основной надписи на выбранных листах должны полностью совпадать. Рекомендуется не использовать в одном проекте разные семейства основных надписей.  
  Ограничения  
  Если на листе размещены более одного экземпляра основной надписи, может привести к непредсказуемым результатам.  
  Если на листах используются разные семейства основной надписи, может привести к непредсказуемым результатам.  
  Для выбора экземпляров основных надписей на выбранных листах `Shift`
